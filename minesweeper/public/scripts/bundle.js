!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";new(n(1).mineSweeper)("game-1")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mineSweeper=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(2);function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.targetEl=t,this.defaultCol=n,this.defaultRow=i,this.col=this.defaultCol,this.row=this.defaultRow,this.defaultMineNum=a,this.mineNum=a,this.newGame()}return i(e,[{key:"generateMap",value:function(){for(var e=[],t=0;t<this.row;t+=1){for(var n=[],i=0;i<this.col;i+=1){var s=new a.Field(t,i,this);n.push(s)}e.push(n)}this._map=e}},{key:"generateMines",value:function(){var e,t=[],n=(e=[]).concat.apply(e,s(this._map)),i=this.startField.x*this._row+this.startField.y;n.splice(i,1);for(var a=0;a<this.mineNum;a+=1){var r=Math.floor(Math.random()*n.length),o=n[r];n.splice(r,1),t.push(this._map[o.x][o.y])}this._mines=t}},{key:"plantMines",value:function(){var e=this;this._mines.forEach(function(t){e._map[t.x][t.y].hasMine=!0})}},{key:"countNeighbours",value:function(){var e=this;this._mines.forEach(function(t){e.getNeighbours(t).forEach(function(e){return e.neighbours+=1})})}},{key:"getNeighbours",value:function(e){for(var t=Math.max(e.x-1,0),n=Math.min(e.x+1,this._map.length-1),i=Math.max(e.y-1,0),a=Math.min(e.y+1,this._map[e.x].length-1),s=[],r=t;r<=n;r+=1)for(var o=i;o<=a;o+=1)this._map[r][o].hasMine||s.push(this._map[r][o]);return s}},{key:"getSafeFields",value:function(){var e,t=this._map.map(function(e){return e.filter(function(e){return!e.hasMine})});this._safeFields=(e=[]).concat.apply(e,s(t))}},{key:"initailizeMap",value:function(e){this.startField=e,this.generateMines(),this.plantMines(),this.getSafeFields(),this.countNeighbours()}},{key:"allSafeRevealed",value:function(){return this._safeFields.every(function(e){return!0===e.isRevealed})}},{key:"generateGameDOM",value:function(){var e=this;this._targetEl.innerHTML="",this._gameContEl=document.createElement("div"),this._gameContEl.classList.add("game-container"),this._gameTopBarEl=document.createElement("div"),this._gameTopBarEl.classList.add("top-bar"),this._gameTopBarEl.addEventListener("contextmenu",function(t){t.preventDefault(),e.showContextMenu(t)}),this._timerEl=document.createElement("div"),this._timerEl.classList.add("timer");var t=document.createElement("div");t.classList.add("btn-new-game"),this._startBtnEl=document.createElement("button"),this._startBtnEl.classList.add("button"),this._startBtnEl.classList.add("button--new-game"),this._startBtnEl.addEventListener("click",function(t){e.newGame()}),t.appendChild(this._startBtnEl),this.mineCounterEl=document.createElement("div"),this.mineCounterEl.classList.add("mine-counter"),this._gameTopBarEl.appendChild(this.mineCounterEl),this._gameTopBarEl.appendChild(t),this._gameTopBarEl.appendChild(this._timerEl);var n=document.createElement("table");n.classList.add("mine-container"),this._mineZone=document.createElement("tbody"),this._mineZone.classList.add("mine-field"),this._mineZone.addEventListener("mousedown",function(t){e._contextMenu&&e._contextMenu.remove(),e.startCounter(),e._startBtnEl.classList.add("mousedown")}),window.addEventListener("click",function(t){e._contextMenu&&e._contextMenu.remove()}),this._mineZone.addEventListener("mouseup",function(t){e._startBtnEl.classList.remove("mousedown")}),this._mineZone.addEventListener("mouseleave",function(t){e._startBtnEl.classList.contains("mousedown")&&e._startBtnEl.classList.remove("mousedown")}),this._mineZone.addEventListener("contextmenu",function(t){e.startCounter(),t.preventDefault()}),n.appendChild(this._mineZone),this._gameContEl.appendChild(this._gameTopBarEl),this._gameContEl.appendChild(n),this._targetEl.appendChild(this._gameContEl)}},{key:"generateField",value:function(){var e=this;this._mineZone.innerHTML="",this._mineZone.classList.add("mine-field"),this._map.forEach(function(t){var n=document.createElement("tr");t.forEach(function(e){n.appendChild(e.el)}),e._mineZone.appendChild(n)})}},{key:"click",value:function(e){var t=this;if(e.hasMine)e.isTriggered=!0,this.gameOver(!1);else{if(0===e.neighbours)this.getNeighbours(e).map(function(e){e.isRevealed?!e.isRevealed&&e.neighbours>0&&(e.isRevealed=!0):(e.isRevealed=!0,t.click(e))});this.allSafeRevealed()&&this.gameOver(!0)}}},{key:"gameOver",value:function(e){this.isGameOver=!0,e?this._startBtnEl.classList.add("win",e):this._startBtnEl.classList.add("lose",!e),this._mines.map(function(e){e.isRevealed=!0}),this.stopCounter()}},{key:"newGame",value:function(){this.generateMap(),this.generateGameDOM(),this.generateField(),this.stopCounter(),this.startField=void 0,this.isGameOver=!1,this.gameTime=0,this.markedMines=0}},{key:"changeOptions",value:function(e){e.col&&(this.col=e.col),e.row&&(this.row=e.row),e.mineNum&&(this.mineNum=e.mineNum)}},{key:"stopCounter",value:function(){clearInterval(this._timer),this._timer=void 0}},{key:"startCounter",value:function(){var e=this;this._timer||this.isGameOver||(this._timer=setInterval(function(){e.gameTime<999&&(e.gameTime+=1)},1e3))}},{key:"showContextMenu",value:function(e){var t=this;this._contextMenu&&this._contextMenu.remove(),this._contextMenu=document.createElement("div"),this._contextMenu.classList.add("context-menu"),this._contextMenu.style.left=e.layerX+"px",this._contextMenu.style.top=e.layerY+"px";var n=document.createElement("ul"),i=document.createElement("li");i.classList.add("menu-el"),i.textContent="Options";var a=document.createElement("li");a.classList.add("menu-el"),a.textContent="About",n.appendChild(i),n.appendChild(a),this._contextMenu.appendChild(n),this._gameTopBarEl.appendChild(this._contextMenu),i.addEventListener("click",function(e){t._contextMenu.remove(),t.showOptionsMenu()}),a.addEventListener("click",function(e){t._contextMenu.remove(),t.showAboutMenu()})}},{key:"showOptionsMenu",value:function(){var e=this,t=document.createElement("div");t.classList.add("menu-page"),t.textContent="Options";var n=document.createElement("div"),i=document.createElement("div"),a=document.createElement("label");a.textContent="Rows:";var s=document.createElement("input");s.setAttribute("type","number"),s.setAttribute("max","100"),s.setAttribute("value",this._row),a.appendChild(s),i.appendChild(a);var r=document.createElement("div"),o=document.createElement("label");o.textContent="Columns:";var u=document.createElement("input");u.setAttribute("type","number"),u.setAttribute("max","100"),u.setAttribute("value",this.col),o.appendChild(u),r.appendChild(o);var l=document.createElement("div"),c=document.createElement("label");c.textContent="Mines:";var d=document.createElement("input");d.setAttribute("type","number"),d.setAttribute("max","100"),d.setAttribute("value",this._mineNum),c.appendChild(d),l.appendChild(c);var h=document.createElement("button");h.classList.add("button"),h.textContent="Save & Restart";var m=document.createElement("button");m.classList.add("button"),m.textContent="Reset & Restart";var f=document.createElement("button");f.classList.add("button"),f.textContent="Cancel",n.appendChild(i),n.appendChild(r),n.appendChild(l),t.appendChild(n),t.appendChild(h),t.appendChild(m),t.appendChild(f),h.addEventListener("click",function(){var n=s.value,i=u.value,a=d.value;e.changeOptions({col:n,row:i,mineNum:a}),e.newGame(),t.remove()}),m.addEventListener("click",function(){e.changeOptions({col:e.defaultCol,row:e.defaultRow,mineNum:e.defaultMineNum}),e.newGame(),t.remove()}),f.addEventListener("click",function(){t.remove()}),this._gameContEl.appendChild(t)}},{key:"showAboutMenu",value:function(){var e=document.createElement("div");e.classList.add("menu-page");var t=document.createElement("ul");t.innerHTML="\n            <li>About</li>\n            <li>You are presented with a board of squares. Some squares contain mines (bombs), others don't.</li>\n            <li>If you click on a square containing a bomb, you lose. If you manage to click all the squares (without clicking on any bombs) you win.</li>\n            <li>Clicking a square which doesn't have a bomb reveals the number of neighbouring squares containing bombs. Use this information plus some guess work to avoid the bombs.</li>\n            <li>To open a square, point at the square and click on it. To mark a square you think is a bomb, point and right-click.</li>\n        ";var n=document.createElement("button");n.classList.add("button"),n.textContent="Close",n.addEventListener("click",function(){e.remove()}),e.appendChild(t),e.appendChild(n),this._gameContEl.appendChild(e)}},{key:"defaultCol",set:function(e){this._defaultCol=e>9?e:9},get:function(){return this._defaultCol}},{key:"col",set:function(e){this._col=e>9?e:9},get:function(){return this._col}},{key:"defaultRow",set:function(e){this._defaultRow=e>9?e:9},get:function(){return this._defaultRow}},{key:"row",set:function(e){this._row=e>9?e:9},get:function(){return this._row}},{key:"defaultMineNum",set:function(e){var t=this.defaultRow*this.defaultCol;this._defaultMineNum=Math.min(Math.max(1,e),t-1)},get:function(){return this._defaultMineNum}},{key:"mineNum",set:function(e){var t=this.row*this.col;this._mineNum=Math.min(Math.max(1,e),t-1)},get:function(){return this._mineNum}},{key:"targetEl",set:function(e){var t=document.getElementById(e);this._targetEl=t||"mine-zone"},get:function(){return this._targetEl}},{key:"isGameOver",set:function(e){this._isGameOver=e,this._mineZone.classList.toggle("game-over",this._isGameOver)},get:function(){return this._isGameOver}},{key:"markedMines",set:function(e){this._markedMines=e,this.mineCounterEl.textContent=(this.mineNum-this._markedMines).toString().padStart(3,"0")},get:function(){return this._markedMines}},{key:"gameTime",set:function(e){this._gameTime=e,this._timerEl.textContent=this._gameTime.toString().padStart(3,"0")},get:function(){return this._gameTime}}]),e}();t.mineSweeper=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(t,n,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clickEventHandler=function(e){a.parent.isGameOver||(a.parent.startField||a.parent.initailizeMap(a),a.isRevealed=!0,a.parent.click(a))},this.contextMenuEventHandler=function(e){a.parent.isGameOver||(a.parent.mineNum-a.parent.markedMines>0?a.isMarked?a.isMarked=!1:a.isMarked=!0:a.parent.mineNum-a.parent.markedMines==0&&a.isMarked&&(a.isMarked=!1)),e.preventDefault()},this.el=document.createElement("td"),this.hasMine=!1,this._isTriggered=!1,this._isRevealed=!1,this._isMarked=!1,this.x=t,this.y=n,this.parent=i,this.neighbours=0,this._text="",this.el.addEventListener("click",this.clickEventHandler),this.el.addEventListener("contextmenu",this.contextMenuEventHandler)}return i(e,[{key:"neighbours",set:function(e){this._text=e>0?e:"",this._neighbours=e},get:function(){return this._neighbours}},{key:"isRevealed",set:function(e){this._isRevealed=e,this.el.classList.add("revealed"),this.isMarked&&(this.isMarked=!1),this.hasMine?this.el.classList.add("mine"):(this.el.textContent=this._text,this.el.classList.add("color-"+this.neighbours)),this.el.removeEventListener("click",this.clickEventHandler),this.el.removeEventListener("contextmenu",this.contextMenuEventHandler)},get:function(){return this._isRevealed}},{key:"isTriggered",set:function(e){this._isTriggered=e,this.el.classList.add("triggered")},get:function(){return this._isTriggered}},{key:"isMarked",set:function(e){this._isMarked=e,this.el.classList.toggle("marked",this._isMarked),this._isMarked?this.parent.markedMines+=1:this.parent.markedMines-=1},get:function(){return this._isMarked}}]),e}();t.Field=a}]);
//# sourceMappingURL=bundle.js.map